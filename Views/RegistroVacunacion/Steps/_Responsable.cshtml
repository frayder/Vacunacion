@model RegistroVacunacionItemViewModel

<div class="card border-0">
    <div class="card-header bg-warning text-dark">
        <h6 class="mb-0 text-dark">
            <i class="ri-user-star-line me-1"></i> Responsable y Finalización
        </h6>
    </div>
    <div class="card-body">
        <!-- Responsable (Nombre del vacunador) -->
        <div class="row">
            <div class="col-md-12">
                <div class="mb-3">
                    <label class="form-label fw-bold">Responsable (Nombre del vacunador)</label>
                    <input type="text" class="form-control" name="Responsable" value="Dr. Administrador" placeholder="Nombre del profesional vacunador" oninput="
                        document.getElementById('resumenVacunador').textContent = this.value || 'No especificado';
                    ">
                </div>
            </div>
        </div>

        <!-- Pregunta PAIWEB -->
        <div class="row">
            <div class="col-md-12">
                <div class="mb-3">
                    <label class="form-label fw-bold">¿Las vacunas fueron ingresadas al aplicativo PAIWEB?</label>
                    <div class="mt-2">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="IngresoPAIWEB" id="paiwebSi" value="si" onchange="
                                document.getElementById('motivoNoIngreso').style.display = 'none';
                                document.getElementById('NotasFinales').required = false;
                                document.getElementById('NotasFinales').value = '';
                                document.getElementById('resumenPAIWEB').textContent = 'Sí - Ingresado en PAIWEB';
                                document.getElementById('resumenPAIWEB').className = 'text-success mb-3';
                            ">
                            <label class="form-check-label" for="paiwebSi">
                                SÍ
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="IngresoPAIWEB" id="paiwebNo" value="no" onchange="
                                document.getElementById('motivoNoIngreso').style.display = 'block';
                                document.getElementById('NotasFinales').required = true;
                                document.getElementById('resumenPAIWEB').textContent = 'No - No ingresado en PAIWEB';
                                document.getElementById('resumenPAIWEB').className = 'text-warning mb-3';
                            ">
                            <label class="form-check-label" for="paiwebNo">
                                NO
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Campo Motivo de no ingreso (aparece solo si se selecciona NO) -->
                <div id="motivoNoIngreso" class="mt-3" style="display: none;">
                    <label class="form-label fw-bold text-danger">Motivo de no ingreso <span class="text-danger">*</span></label>
                    <textarea class="form-control" name="MotivoNoIngresoPAIWEB" id="motivoNoIngresoPAIWEB" rows="4" 
                              placeholder="Describa el motivo por el cual las vacunas no fueron ingresadas al sistema PAIWEB (ej: sistema no disponible, falta de conectividad, problemas técnicos, etc.)"
                              oninput="
                                  const resumenElement = document.getElementById('resumenPAIWEB');
                                  if (this.value.trim()) {
                                      const motivoCorto = this.value.length > 50 ? this.value.substring(0, 50) + '...' : this.value;
                                      resumenElement.textContent = 'No - No ingresado en PAIWEB (' + motivoCorto + ')';
                                  } else {
                                      resumenElement.textContent = 'No - No ingresado en PAIWEB';
                                  }
                                  resumenElement.className = 'text-warning mb-3';
                              "></textarea>
                    <div class="form-text">
                        <i class="ri-information-line me-1"></i>
                        Indique claramente el motivo por el cual no se pudo realizar el ingreso al sistema PAIWEB para efectos de seguimiento y control.
                    </div>
                </div>
            </div>
        </div>

        <!-- Centro de salud -->
        <div class="row">
            <div class="col-md-12">
                <div class="mb-3">
                    <label class="form-label fw-bold">Centro de salud</label>
                    <select class="form-select" name="CentroSaludResponsable">
                        <option value="">Sistema Central</option>
                        <!-- Opciones se cargarán dinámicamente -->
                    </select> 
                </div>
            </div>
        </div>

        <!-- Notas -->
        <div class="row">
            <div class="col-md-12">
                <div class="mb-4">
                    <label class="form-label fw-bold">Notas</label>
                    <textarea class="form-control" name="NotasFinales" rows="4" placeholder="Observaciones adicionales, comentarios especiales, etc..."></textarea>
                </div>
            </div>
        </div>

        <!-- Resumen del registro -->
        <div class="card mt-4 mb-4">
            <div class="card-header bg-light">
                <h6 class="mb-0 text-primary">
                    <i class="ri-file-list-3-line me-1"></i> Resumen del registro
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <p class="mb-1"><strong>Vacunador:</strong></p>
                        <p class="text-muted mb-3" id="resumenVacunador">Dr. Administrador</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1"><strong>Centro de salud:</strong></p>
                        <p class="text-muted mb-3" id="resumenCentro">Sistema Central</p>
                    </div>
                    <div class="col-md-4">
                        <p class="mb-1"><strong>Estado PAIWEB:</strong></p>
                        <p class="text-muted mb-3" id="resumenPAIWEB">No especificado</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Listo para guardar -->
        <div class="alert alert-success" role="alert">
            <div class="d-flex align-items-center">
                <i class="ri-checkbox-circle-line me-2 fs-4 text-success"></i>
                <div>
                    <h6 class="alert-heading mb-1">Listo para guardar</h6>
                    <p class="mb-0">Ha completado todos los pasos del formulario de vacunación. Puede navegar entre los pasos anteriores para revisar la información o hacer clic en "Guardar Registro" para finalizar.</p>
                </div>
            </div>
        </div>

        <!-- Confirmación final -->
        <div class="row">
            <div class="col-md-12">
                <div class="form-check p-3 bg-light rounded">
                    <input class="form-check-input" type="checkbox" name="ConfirmacionFinal" id="confirmacionFinal" required>
                    <label class="form-check-label fw-bold" for="confirmacionFinal">
                        <i class="ri-shield-check-line me-1 text-success"></i>
                        Confirmo que toda la información ingresada es correcta y autorizo el registro de vacunación
                        <span class="text-danger">*</span>
                    </label>
                    <div class="form-text mt-2">
                        Al marcar esta casilla, usted confirma la veracidad de todos los datos ingresados y autoriza el procesamiento de esta información según las normativas vigentes de salud pública.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

